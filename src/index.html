<!DOCTYPE html>
<html lang="en">
<head>
    <title>AdMove</title>
    <meta charset="UTF-8">

    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="540992315724-2o030a2cdrfnflqp1mgat5ekn616ae54.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
</head>
<body>
Hello
<script src="https://sdk.amazonaws.com/js/aws-sdk-2.1.41.min.js"></script>
<script>

    AWS.config.region = 'us-east-1';


    (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s);
        js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    window.fbAsyncInit = function () {
        FB.init({
            appId: '181154708936062',
            cookie: true,

            xfbml: true,
            version: 'v2.5'
        });
        FB.getLoginStatus(statusChangeCallback);
    };


    function statusChangeCallback(response) {
        console.log('statusChangeCallback', response);

        if (response.status === 'connected' && response.authResponse) {

            testAPI();

            AWS.config.credentials = new AWS.CognitoIdentityCredentials({
                IdentityPoolId: 'us-east-1:dc8ac281-9b58-4846-ad05-862c2f5c59d8',
                Logins: {'graph.facebook.com': response.authResponse.accessToken}
            });

            AWS.config.credentials.get(function (err) {
                if (err) return console.log("Error", err);
                console.log("Cognito Identity Id", AWS.config.credentials.identityId);
            });

        } else if (response.status === 'not_authorized') {
            document.getElementById('status').innerHTML = 'Please log into this app.';
        } else {
            document.getElementById('status').innerHTML = 'Please log into Facebook.';
        }
    }


    function testAPI() {
        console.log('Welcome!  Fetching your information.... ');
        FB.api('/me', function (response) {
            console.log('Successful login for: ' + response.name);
            document.getElementById('status').innerHTML = 'Thanks for logging in, ' + response.name + '!';
        });
    }

    function fbLogout() {
        FB.logout(function (result) {
            statusChangeCallback(result);
        });
    }


</script>


<fb:login-button scope="public_profile,email" onlogin="FB.getLoginStatus(statusChangeCallback);"></fb:login-button>

<div id="status"></div>

<button onclick="fbLogout()">Log out</button>

<br>
<hr>
<br>
<div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark"></div>
<button onclick="googleLogout()">Google logout</button>
<script>
    function onSignIn(googleUser) {
        // Useful data for your client-side scripts:
        var profile = googleUser.getBasicProfile();
        console.log("ID: " + profile.getId()); // Don't send this directly to your server!
        console.log('Full Name: ' + profile.getName());
        console.log('Given Name: ' + profile.getGivenName());
        console.log('Family Name: ' + profile.getFamilyName());
        console.log("Image URL: " + profile.getImageUrl());
        console.log("Email: " + profile.getEmail());

        // The ID token you need to pass to your backend:
        var id_token = googleUser.getAuthResponse().id_token;
        console.log("google ID Token: " + id_token);

        AWS.config.credentials = new AWS.CognitoIdentityCredentials({
            IdentityPoolId: 'us-east-1:dc8ac281-9b58-4846-ad05-862c2f5c59d8',
            Logins: {'accounts.google.com': id_token}
        });

        AWS.config.credentials.get(function (err) {
            if (err) return console.log("Error", err);
            console.log("Cognito Identity Id", AWS.config.credentials.identityId);
        });
    };

    function googleLogout(){
        var auth2 = gapi.auth2.getAuthInstance();
        auth2.signOut().then(function () {
            console.log('google User signed out.');
        });
    }
</script>

</body>
</html>